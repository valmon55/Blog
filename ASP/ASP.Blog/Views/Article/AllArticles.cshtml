@model List<ASP.Blog.BLL.ViewModels.Article.ArticleViewModel>

@using ASP.Blog.Data.Entities;
@using Microsoft.AspNetCore.Identity;
@inject SignInManager<User> SignInManager;
@inject UserManager<User> UserManager;


@{
    @if (SignInManager.IsSignedIn(User))
    {
        ViewData["Title"] = "Cтатьи пользователя";
    }
    else
    {
        ViewData["Title"] = "Все cтатьи";
    }
}

<script src="https://ajax.aspnetcdn.com/ajax/jquery.validate/1.17.0/jquery.validate.min.js"></script>
<script src="https://ajax.aspnetcdn.com/ajax/jquery.validation.unobtrusive/3.2.10/jquery.validate.unobtrusive.min.js"></script>

@*<h2></h2>*@

<div>    
    @if (SignInManager.IsSignedIn(User))
    {
        <h4>Мои статьи</h4>
        @*<form method="get" asp-controller="Article" asp-action="AllUserArticles">*@
            @foreach(var article in @Model)
            {
                <div>
                    <hr>
                    <textarea placeholder="Текст статьи">@article.Content</textarea>        
                    <form method="post" asp-controller="Article" asp-action="Update" asp-route-id=@article.Id>
                        <input type="submit" value="Обновить" />
                    </form>
                    <form method="post" asp-controller="Article" asp-action="Delete" asp-route-id=@article.Id>
                        <input type="submit" value="Удалить" />
                    </form>
                </div>
            }
        @*</form>*@
        <form method="get" asp-controller="Article" asp-action="Add">
            <input type="submit" value="Написать новую статью"/>
        </form>
    }
    else
    {
        <h4>Эти статьи может увидеть любой пользователь.</h4>
        <form method="get" asp-controller="Article" asp-action="AllArticles">
            @foreach(var article in Model)
            {
                <div>
                    <hr>
                    <textarea placeholder="Текст статьи">@article.Content</textarea>        
                </div>
            }
        </form>
    }
</div>
